{"version":3,"file":"helper.min.js","sources":["../src/helper.js"],"sourcesContent":["define(['jquery',\r\n        'block_learnerscript/ajax',\r\n        'block_learnerscript/ajaxforms',\r\n        'core/str',\r\n        'core/modal_factory',\r\n        'core/modal_events',\r\n        'core/ajax',\r\n        'core/notification',\r\n        'block_learnerscript/smartfilter',\r\n        'block_learnerscript/bootstrapnotify'\r\n    ],\r\n    function($, ajax, AjaxForms, Str, ModalFactory, ModalEvents, Ajax, notification, smartfilter) {\r\n        return helper = {\r\n            sendmessage: function(args, username) {\r\n                    Str.get_strings([{\r\n                    key: 'sendmessage',\r\n                    component: 'block_learnerscript'\r\n                }, {\r\n                    key: 'messageconformation',\r\n                    component: 'block_learnerscript'\r\n                }, {\r\n                    key: 'messagesent',\r\n                    component: 'block_learnerscript'\r\n                }]).then(function(s) {\r\n                var userid = args.userid;\r\n                var reportinstance = args.reportinstance;\r\n                var formid = \"form_sendsms\" + userid;\r\n                var container = $(\"#sendsms_\" + reportinstance + '_' + userid).parents('table');\r\n                if ($('#ls_sendsms_' + reportinstance + '_' + userid).length < 1) {\r\n                    $(\"#sendsms_\" + reportinstance + '_' + userid).append('<div id=\"ls_sendsms_' + reportinstance + '_' + userid + '\" class=\"sendmessage\"><div class=\"messageloading\"></div><form id=\"' + formid + '\" ><textarea id=\"text_' + formid + '\" type=\"text\" name=\"message\"></textarea><input type=\"submit\" value = \"Submit\"></form></div>');\r\n                }\r\n                var dlg = $('#ls_sendsms_' + reportinstance + '_' + userid).dialog({\r\n                    resizable: true,\r\n                    autoOpen: false,\r\n                    width: \"20%\",\r\n                    title: s[0],\r\n                    modal: false,\r\n                    dialogClass: 'sendsmsdialog',\r\n                    show: {\r\n                        effect: \"slide\",\r\n                        duration: 1000\r\n                    },\r\n                    position: {\r\n                        my: \"left\",\r\n                        at: \"right\",\r\n                        of: \"#sendsms_\" + reportinstance + '_' + userid,\r\n                        within: container\r\n                    },\r\n                    open: function(event, ui) {\r\n                        $(this).closest(\".ui-dialog\")\r\n                            .find(\".ui-dialog-titlebar-close\")\r\n                            .removeClass(\"ui-dialog-titlebar-close\")\r\n                            .html(\"<span class='ui-button-icon-primary ui-icon ui-icon-closethick'></span>\");\r\n                            var Closebutton = $('.ui-icon-closethick').parent();\r\n                            $(Closebutton).attr({\r\n                                \"title\" : \"Close\"\r\n                            });\r\n                        $(\".sendmessage\").not(this).each(function() {\r\n                            $(this).remove();\r\n                        });\r\n                    },\r\n                    close: function(event, ui) {\r\n                        $(this).dialog('destroy').remove();\r\n                    }\r\n                });\r\n                dlg.dialog(\"open\");\r\n                $(\"#\" + formid).submit(function(e) {\r\n                    e.preventDefault();\r\n                    var helper = require('block_learnerscript/helper');\r\n                    var emptymessage = document.getElementById(\"text_\" + formid).value;\r\n                    if (!emptymessage) {\r\n                        $('.messageloading').html('<div class=\"alert alert-danger\">You must supply a value here</div>');\r\n                    } else {\r\n                        url = require('core/url');\r\n                        $('.messageloading').html('<center><img src=\"' + url.imageUrl(\"loader\", \"block_learnerscript\") + '\" alt=\"Message Sending\" title=\"Message Sending\"/></center>');\r\n                        $(\"#\" + formid).hide();\r\n                        var promise = Ajax.call([{\r\n                            methodname: 'core_message_send_instant_messages',\r\n                            args: {\r\n                                messages: [{\r\n                                    touserid: args.userid,\r\n                                    text: $(\"#\" + formid).serializeObject().message,\r\n                                    textformat: 0\r\n                                }]\r\n                            }\r\n                        }]);\r\n                    }\r\n                    promise[0].done(function(response) {\r\n                        var message = s[2] + username\r\n                        helper.notifications(message);\r\n                        dlg.dialog(\"close\");\r\n                    }).fail(function(ex) {\r\n                        // do something with the exception\r\n                        //  console.log(ex);\r\n                        $('.messageloading').html('<div class=\"alert alert-warning\">' + ex.message + '</div>');\r\n                        // $(\"#\"+formid).show();\r\n                    });\r\n                })\r\n            });\r\n            },\r\n            ViewReportFilters: function(args) {\r\n                $('.' + args.activefilter).toggleClass(\"show\");\r\n                $('.' + args.inactivefilter).removeClass(\"show\");\r\n            },\r\n            deleteConfirm: function(args) {\r\n                // var action = $(elem).data('action');\r\n                return Str.get_strings([{\r\n                    key: 'deleteconfirmation',\r\n                    component: 'block_learnerscript'\r\n                }, {\r\n                    key: 'deleteallconfirm',\r\n                    component: 'block_learnerscript'\r\n                },{\r\n                    key:'graphdeleted',\r\n                    component:'block_learnerscript'\r\n                },{\r\n                    key:'graphcannotbedeleted',\r\n                    component:'block_learnerscript'\r\n                }]).then(function(s) {\r\n                    ModalFactory.create({\r\n                        title: s[0],\r\n                        type: ModalFactory.types.SAVE_CANCEL,\r\n                        body: s[1]\r\n                    }).done(function(modal) {\r\n                        this.modal = modal;\r\n                        modal.setSaveButtonText('Confirm');\r\n                        modal.getRoot().on(ModalEvents.save, function(e) {\r\n                            e.preventDefault();\r\n                            var helper = require('block_learnerscript/helper');\r\n                            var promise = Ajax.call([{\r\n                                methodname: 'block_learnerscript_' + args.action,\r\n                                args: args\r\n                            }]);\r\n                            promise[0].done(function(resp) {\r\n                                $('.plotgraphcontainer').removeClass('show').addClass('hide');\r\n                                $('#plotreportcontainer' + args.reportid).html('');\r\n\r\n                                // var activetab = $( \"#report_plottabs\" ).tabs( \"option\", \"active\" );\r\n                                // var activetabid = $( \"#report_plottabs li:eq(\" + activetab + \")\" ).data('cid');\r\n                                var tabdata = $('#' + args.cid).attr('aria-controls');\r\n                                $(\"[data-cid='\" + args.cid + \"']\").remove();\r\n                                $('#' + tabdata).remove();\r\n                                // $('#report_plottabs').tabs('destroy').tabs();\r\n                                // $('#report_plottabs').tabs( \"refresh\" );\r\n                                // if ($( \"#report_plottabs li:eq(0) a\" ).length > 0) {\r\n                                //     $( \"#report_plottabs li:eq(0) a\" ).trigger('click');\r\n                                // } else\r\n                                if ($( \"#report_plottabs li:eq(0) a\" ).length < 1) {\r\n                                    $('#report_plottabs').remove();\r\n                                }\r\n\r\n                                helper.notifications(s[2]);\r\n                                // window.location.href = window.location.href;\r\n                            }).fail(function(ex) {\r\n                                // do something with the exception\r\n                                console.log(ex);\r\n                            });\r\n                            modal.hide();\r\n                            modal.destroy();\r\n                        }.bind(this));\r\n                        modal.show();\r\n                        $('.modal-header button.close').attr('title','Close');\r\n                    }.bind(this));\r\n                }.bind(this));\r\n            },\r\n            validatebasicform: function(validate) {\r\n                var getreport = [];\r\n                if (typeof validate == 'undefined') {\r\n                    $.each($('.basicparamsform select'), function(index, value) {\r\n                        var selectedval = $(value).val();\r\n                        if (selectedval == 0) {\r\n                            getreport.push(0);\r\n                        }\r\n                    });\r\n                }\r\n                return getreport;\r\n            },\r\n            Preview: function(args) {\r\n                $(args.container).dialog({\r\n                    dialogClass: 'previewpopup',\r\n                    width: '95%',\r\n                    modal: true,\r\n                    position: {\r\n                        my: 'center',\r\n                        at: 'center',\r\n                        within: '.ls_components'\r\n                        //of: 'body'\r\n                    },\r\n                    close: function() {\r\n                        $(this).dialog('destroy');\r\n                    },\r\n                    open: function() {\r\n                        $(this).closest(\".ui-dialog\")\r\n                            .find(\".ui-dialog-titlebar-close\")\r\n                            .removeClass(\"ui-dialog-titlebar-close\")\r\n                            .html(\"<span class='ui-button-icon-primary ui-icon ui-icon-closethick'></span>\");\r\n                            var Closebutton = $('.ui-icon-closethick').parent();\r\n                            $(Closebutton).attr({\r\n                                \"title\" : \"Close\"\r\n                            });\r\n                        // $(this).closest(\".ui-dialog\")\r\n                        //     .find('.ui-dialog-title').html(title_img + self.args.title);\r\n                    }\r\n                });\r\n            },\r\n            /**\r\n             * Central method for call Select2 with Ajax in reports module\r\n             * @param object args Object with reportID and other required params\r\n             */\r\n            Select2Ajax: function(args) {\r\n                $(\"select[data-select2-ajax='1']\").each(function() {\r\n                    var instanceid = $(this).data('instanceid');\r\n                    var reportinstance = instanceid ? instanceid : args.reportid;\r\n                    if (args.action == 'rolewiseusers') {\r\n                        args.reportid = $(this).data('reportid');\r\n                        args.courses =  $('[name=\"filter_courses\"]').val();\r\n                    }\r\n                    if (args.action === 'userlist') {\r\n                        args.setminimumInputLength = 2;\r\n                        args.courses =  $('[name=\"filter_courses\"]').val();\r\n                    }\r\n                    if (!$(this).hasClass('select2-hidden-accessible')) {\r\n                        $(this).select2({\r\n                            // multiple: args.multiple || false,\r\n                            ajax: {\r\n                                data: function(params) {\r\n                                    var dataaction = $(this).data('action');\r\n\r\n                                    if (dataaction == 'filterusers' || dataaction == 'filtercourses') {\r\n                                        args.action = dataaction;\r\n                                        args.basicparamdata = JSON.stringify(smartfilter.BasicparamsData(reportinstance));\r\n                                        args.fiterdata = JSON.stringify(smartfilter.FilterData(reportinstance));\r\n                                        args.reportinstanceid = instanceid;\r\n                                        args.courses = $('[name=\"filter_courses\"]').val();\r\n\r\n                                    }\r\n                                    if (args.action == 'rolewiseusers') {\r\n                                        delete args.schuserslist;\r\n                                        delete args.scheduleid;\r\n                                        args.roleid = $(\"#id_role\" + reportinstance).val();\r\n                                        var roleid = args.roleid.split('_');\r\n                                        args.roleid = roleid[0];\r\n                                        args.contextlevel = roleid[1];\r\n                                        args.courses = $('[name=\"filter_courses\"]').val();\r\n\r\n                                    }\r\n                                    $.extend(params, args);\r\n                                    methodname2 = args.action;\r\n                                    if (methodname2 === 'userlist') {\r\n                                        $blockname = 'block_reportdashboard_';\r\n                                    } else {\r\n                                        $blockname = 'block_learnerscript_';\r\n                                    }\r\n\r\n                                    return params;\r\n                                },\r\n                                transport: function(params, success, failure) {\r\n                                    params.data.roleid = params.data.roleid;\r\n                                    var promise = Ajax.call([{\r\n                                        methodname: $blockname + methodname2,\r\n                                        args: params.data\r\n                                    }]);\r\n                                    promise[0].done(function(data) {\r\n                                        data = $.parseJSON(data);\r\n                                        success(data);\r\n                                    });\r\n                                    promise[0].fail(function(failure) {\r\n                                        // do something with the exception\r\n                                        //  console.log(failure);\r\n                                    });\r\n                                },\r\n                                processResults: function(data, params) {\r\n                                    // parse the results into the format expected by Select2\r\n                                    // since we are using custom formatting functions we do not need to\r\n                                    // alter the remote JSON data, except to indicate that infinite\r\n                                    // scrolling can be used\r\n                                    params.page = params.page || 1;\r\n                                    var pagination = false;\r\n                                    if (args.action === 'userlist' || args.action == 'filtercourses' || args.action == 'filterusers') {\r\n                                        pagination = false;\r\n                                    } else {\r\n                                        pagination = (params.page * 10) < data.total_count;\r\n                                    }\r\n                                    return {\r\n                                        results: data.items,\r\n                                        pagination: {\r\n                                                more: pagination\r\n                                        }\r\n                                    };\r\n                                }\r\n                            },\r\n                            escapeMarkup: function(markup) {\r\n                                return markup;\r\n                            }, // let our custom formatter work\r\n                            minimumInputLength: args.setminimumInputLength || 1,\r\n                            maximumSelectionLength: args.maximumSelectionLength,\r\n                            language: {\r\n                                // You can find all of the options in the language files provided in the\r\n                                // build. They all must be functions that return the string that should be\r\n                                // displayed.\r\n                                maximumSelected: function(params) {\r\n                                    if (args.action == 'rolewiseusers') {\r\n                                        args.roleid = $(\"#id_role\" + reportinstance).val();\r\n                                        args.schuserslist = $('#schuserslist' + reportinstance).val();\r\n                                        args.scheduleid = $(\"#scheduleid\").val() || -1;\r\n                                        return \"Click <a href='javascript:void(0);' class='seluser' id='addusers\" + args.reportid + \"' \\\r\n                                                     data-reportid=\" + args.reportid + \" data-scheduleid = \" + args.scheduleid + \" \\\r\n                        onclick = '(function(e){ require(\\\"block_learnerscript/schedule\\\").manageschusers(\\\r\n                                                     {reportinstance:\" + reportinstance + \", reportid:\" + args.reportid + \",scheduleid:\" + args.scheduleid + \",selectedroleid:\" + args.roleid + \",\\\r\n                                                     schuserslist:\\\"\" + args.schuserslist + \"\\\"}) })(event)' > here </a> to add more than \" + params.maximum + \" users.\";\r\n                                    }\r\n                                }\r\n                            },\r\n                            templateResult: function formatRepo(repo) {\r\n                                var markup;\r\n                                if (repo.loading) {\r\n                                    return repo.text || \"Values not supported\";\r\n                                }\r\n                                markup = repo.text || \"Values not supported\";\r\n                                return markup;\r\n                            }, // omitted for brevity, see the source of this page\r\n                            templateSelection: function formatRepoSelection(repo) {\r\n                                var markup;\r\n                                if (repo.id == -1 && args.action == 'rolewiseusers') {\r\n                                    var reportid = repo.element.form.dataset.reportid || 0;\r\n                                    var scheduleid = repo.element.form.dataset.scheduleid || -1;\r\n                                    markup = \"<a href='javascript:void(0)' class='viewschusers'\" +\r\n                                        \"onclick='(function(e){ require(\\\"block_learnerscript/schedule\\\").viewschusers( \\\r\n                                            {reportid:\" + reportid + \",scheduleid:\" + scheduleid + \", reportinstance:\" + reportinstance + \"}) })(event);'>\" + repo.text + \"</a>\";\r\n                                } else {\r\n                                    markup = repo.text;\r\n                                }\r\n                                return markup;\r\n                            } // omitted for brevity, see the source of this page\r\n                        }).on('select2:select', function(evt) {\r\n                            if (args.action == 'reportlist') {\r\n                                var reportid = $(this).val();\r\n                                window.location = M.cfg.wwwroot + '/blocks/learnerscript/viewreport.php?id=' + reportid;\r\n                            }\r\n                        });\r\n                    }\r\n                });\r\n            },\r\n            getQueryParameters: function(str) {\r\n                return (str || document.location.search).replace(/(\\?)/, '&').split(\"&\").map(function(n) { return n = n.split(\"=\"), this[n[0]] = n[1], this }.bind({}))[0];\r\n            },\r\n            DrilldownReport: function() {\r\n                var self = this;\r\n                //Drill down report\r\n                $('td a').click(function(e) {\r\n                    var url = $(this).attr('href');\r\n                    var drillurl = self.getQueryParameters(url);\r\n                    if (url.indexOf('viewreport.php') <= 0 || \"download\" in drillurl) {\r\n                        return;\r\n                    }\r\n                    e.preventDefault();\r\n                    self.ReportModelFromLink({ container: $(this), url: url });\r\n\r\n                });\r\n            },\r\n            ReportModelFromLink: function(args) {\r\n                var tableid = args.container.parents().closest('table').attr('id');\r\n                var tablewidth = $(\"#\" + tableid + \"\").width();\r\n                var drillurl = this.getQueryParameters(args.url);\r\n                var reportid = parseInt(drillurl.id);\r\n                var drilldata = $(this).data();\r\n                var filter = {};\r\n                if (args.url.indexOf('viewreport.php') <= 0 || \"download\" in drillurl) {\r\n                    return;\r\n                }\r\n                $.each(drillurl, function(key, val) {\r\n                    if (key.indexOf('filter') >= 0) {\r\n                        filter[key] = val;\r\n                    }\r\n                });\r\n                if ($(\"#reportcontainer\" + reportid).length == 0 || $(\"#plotreportcontainer\" + reportid).length == 0) {\r\n                    $('body').append('<div id=\"reportcontainer' + reportid + '\" style=\"display:none;\"></div>');\r\n                    $('body').append('<div id=\"plotreportcontainer' + reportid + '\" class=\"dialogplot\" style=\"display:none;\"></div>');\r\n                    var promise = ajax.call({\r\n                        args: {\r\n                            action: 'disablecolumnstatus',\r\n                            reportid: reportid\r\n                        },\r\n                        url: M.cfg.wwwroot + \"/blocks/learnerscript/ajax.php\",\r\n                    });\r\n                    promise.done(function(response) {\r\n                        var reporttypes = response;\r\n                        reportwidget.CreateDashboardwidget({\r\n                            reportid: reportid,\r\n                            reporttype: response,\r\n                            basicparams: JSON.stringify(filter),\r\n                            ls_fstartdate: 0,\r\n                            ls_fenddate: $.now()\r\n                        });\r\n                        chart.SparkLineReport();\r\n                        if(reporttypes == 'table') {\r\n                            dialogid = \"reportcontainer\";\r\n                        } else {\r\n                            dialogid = \"plotreportcontainer\";\r\n                        }\r\n                        var dlg = $(\"#\" + dialogid + reportid + \"\").dialog({\r\n                            resizable: true,\r\n                            autoOpen: false,\r\n                            dialogClass: \"drilldown\" + reportid,\r\n                            width: tablewidth,\r\n                            title: '',\r\n                            appendTo: \"#\" + tableid,\r\n                            modal: true,\r\n                            position: {\r\n                                my: \"center\",\r\n                                at: \"top\",\r\n                                of: \"#\" + tableid\r\n                            },\r\n                            open: function(event) {\r\n                                $(this).closest(\".ui-dialog\")\r\n                                    .find(\".ui-dialog-titlebar-close\")\r\n                                    .removeClass(\"ui-dialog-titlebar-close\")\r\n                                    .html(\"<span class='ui-button-icon-primary ui-icon ui-icon-closethick'></span>\");\r\n                                    var Closebutton = $('.ui-icon-closethick').parent();\r\n                                    $(Closebutton).attr({\r\n                                        \"title\" : \"Close\"\r\n                                    });\r\n                                $(\".drilldown\" + reportid).append('<a href=' + args.url + '><span class=\"reportdashboard_right\">View more</span></a>');\r\n                            },\r\n                            close: function(event, ui) {\r\n                                $(this).dialog('destroy').remove();\r\n                            }\r\n                        });                \r\n                        dlg.dialog(\"open\").prev(\".ui-dialog-titlebar\").css(\"color\", \"#0C75B6\");\r\n                    });\r\n                }\r\n            },\r\n            PlotForm: function(args) {\r\n                url = M.cfg.wwwroot + '/blocks/learnerscript/ajax.php';\r\n                args.title = (!args.title) ? 'Plot Graph' : args.title;\r\n                AjaxForms.init(args, url);\r\n            },\r\n            reportCalculations: function(args) {\r\n                Str.get_string('calcs','block_learnerscript').then(function(s) {\r\n                var title_img = \"<img class='dialog_title_icon' alt='Calculations' src='\" +\r\n                    M.util.image_url(\"schedule_icon\", \"block_learnerscript\") + \"'/>\";\r\n                var dlg = $(\".reportcalculation\" + args.reportid).dialog({\r\n                    dialogClass: 'calculationspopup',\r\n                    resizable: false,\r\n                    autoOpen: false,\r\n                    width: \"50%\",\r\n                    title: 'Calculations',\r\n                    modal: true,\r\n                    position: {\r\n                        my: \"center\",\r\n                        at: \"center\",\r\n                        of: window\r\n                    },\r\n                    open: function(event, ui) {\r\n                        $(\".reportcalculation\" + args.reportid).append('<img src=\"' + M.util.image_url('loading', 'block_learnerscript') + '\" id=\"loadingimage\" />');\r\n                        $(document).ajaxStop(function() {\r\n                            $(\"#loadingimage\").remove();\r\n                        });\r\n                        $(this).closest(\".ui-dialog\").find(\".ui-dialog-titlebar-close\")\r\n                            .removeClass(\"ui-dialog-titlebar-close\")\r\n                            .html(\"<span class='ui-button-icon-primary ui-icon ui-icon-closethick'></span>\");\r\n                            var Closebutton = $('.ui-icon-closethick').parent();\r\n                            $(Closebutton).attr({\r\n                                \"title\" : \"Close\"\r\n                            });\r\n                        $(this).closest(\".ui-dialog\").find('.ui-dialog-title')\r\n                            .html('Calculations');\r\n                    }\r\n\r\n                });\r\n                args.filters = smartfilter.FilterData(args.reportid);\r\n                args.filters['ls_fstartdate'] = $('#ls_fstartdate').val();\r\n                args.filters['ls_fenddate'] = $('#ls_fenddate').val();\r\n                if (typeof args.filters['filter_courses'] == 'undefined') {\r\n                    var filter_courses = $('#ls_courseid').val();\r\n                    if (filter_courses != 1) {\r\n                        args.filters['filter_courses'] = filter_courses;\r\n                    }\r\n                }\r\n                args.filters = JSON.stringify(args.filters);\r\n\r\n                args.action = 'reportcalculations';\r\n\r\n                args.basicparams = args.basicparams || JSON.stringify(smartfilter.BasicparamsData(args.reportid));\r\n                var promise = ajax.call({\r\n                    args: args,\r\n                    url: M.cfg.wwwroot + \"/blocks/learnerscript/ajax.php\"\r\n                });\r\n                promise.done(function(response) {\r\n                    $(\".reportcalculation\" + args.reportid).closest(\".ui-dialog\").find('.ui-dialog-title')\r\n                        .html(response.reportname + ' : Calculations');\r\n                    $(\".reportcalculation\" + args.reportid).html(response.table);\r\n                }).fail(function(ex) {\r\n                    // do something with the exception\r\n                    //  console.log(ex);\r\n                });\r\n                dlg.dialog(\"open\");\r\n                }.bind(this));\r\n            },\r\n            dropdown: function(child) {\r\n                $('#' + child).toggle();\r\n            },\r\n            notifications: function(elements, notifytype){\r\n                notifytype = notifytype || 'success';\r\n                $.notify({\r\n                    message: elements\r\n                },{\r\n                    type: notifytype\r\n                }\r\n                );\r\n            },\r\n            tabsdraggable: function($tabs) {\r\n                $( \".ls-plotgraphs_list\" ).sortable({\r\n                    cursor: 'move',\r\n                    axis: 'y',\r\n                    update: function (event, ui) {\r\n                        var elementsorder = $('.ls-plotgraphs_list').sortable('toArray', {attribute: 'data-cid'}).toString();\r\n                        var promise = ajax.call({\r\n                            args: {\r\n                                action: 'tabsposition',\r\n                                reportid: $('.ls-plotgraphs_list').data('reportid'),\r\n                                component: 'plot',\r\n                                elementsorder: elementsorder\r\n                            },\r\n                            url: M.cfg.wwwroot + \"/blocks/learnerscript/ajax.php\"\r\n                        });\r\n                    }\r\n                });\r\n            },\r\n            rolesforcontext: function(contextlevel, reportid){\r\n                var promise = ajax.call({\r\n                    args: {\r\n                        action: 'contextroles',\r\n                        contextlevel: contextlevel,\r\n                        reportid: reportid\r\n                    },\r\n                    url: M.cfg.wwwroot + \"/blocks/learnerscript/ajax.php\",\r\n                });\r\n                promise.done(function(response) {\r\n                    var template = '';\r\n                    $.each(response, function(key, value) {\r\n                        template += '<option value = ' + key + '>' + value + '</option>';\r\n                    });\r\n                    $(\"#id_roleid\").find('option').remove().end().append(template);\r\n                });\r\n            }\r\n        }\r\n    });\r\n"],"names":["define","$","ajax","AjaxForms","Str","ModalFactory","ModalEvents","Ajax","notification","smartfilter","helper","sendmessage","args","username","get_strings","key","component","then","s","userid","reportinstance","formid","container","parents","length","append","dlg","dialog","resizable","autoOpen","width","title","modal","dialogClass","show","effect","duration","position","my","at","of","within","open","event","ui","this","closest","find","removeClass","html","Closebutton","parent","attr","not","each","remove","close","submit","e","preventDefault","require","document","getElementById","value","url","imageUrl","hide","promise","call","methodname","messages","touserid","text","serializeObject","message","textformat","done","response","notifications","fail","ex","ViewReportFilters","activefilter","toggleClass","inactivefilter","deleteConfirm","create","type","types","SAVE_CANCEL","body","setSaveButtonText","getRoot","on","save","action","resp","addClass","reportid","tabdata","cid","console","log","destroy","bind","validatebasicform","validate","getreport","index","val","push","Preview","Select2Ajax","instanceid","data","courses","setminimumInputLength","hasClass","select2","params","dataaction","basicparamdata","JSON","stringify","BasicparamsData","fiterdata","FilterData","reportinstanceid","schuserslist","scheduleid","roleid","split","contextlevel","extend","methodname2","$blockname","transport","success","failure","parseJSON","processResults","page","pagination","total_count","results","items","more","escapeMarkup","markup","minimumInputLength","maximumSelectionLength","language","maximumSelected","maximum","templateResult","repo","loading","templateSelection","id","element","form","dataset","evt","window","location","M","cfg","wwwroot","getQueryParameters","str","search","replace","map","n","DrilldownReport","self","click","drillurl","indexOf","ReportModelFromLink","tableid","tablewidth","parseInt","filter","reporttypes","reportwidget","CreateDashboardwidget","reporttype","basicparams","ls_fstartdate","ls_fenddate","now","chart","SparkLineReport","dialogid","appendTo","prev","css","PlotForm","init","reportCalculations","get_string","util","image_url","ajaxStop","filters","filter_courses","reportname","table","dropdown","child","toggle","elements","notifytype","notify","tabsdraggable","$tabs","sortable","cursor","axis","update","elementsorder","attribute","toString","rolesforcontext","template","end"],"mappings":"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"}