{"version":3,"file":"lsreportconfig.min.js","sources":["../src/lsreportconfig.js"],"sourcesContent":["define(['core/ajax',\r\n    'jquery',\r\n    'jqueryui'\r\n], function(Ajax, $) {\r\n    var lsreportconfig = {\r\n        slideIndex: 1,\r\n        currentSlide: function(currentSlideIndex) {\r\n            lsreportconfig.lsreportslideshow(lsreportconfig.slideIndex = currentSlideIndex);\r\n        },\r\n\r\n        progressbar: $( \"#progressbar\" ),\r\n\r\n        lsreportslideshow: function(currentSlideIndex) {\r\n            var i;\r\n            var slides = document.getElementsByClassName(\"mySlides\");\r\n            var dots = document.getElementsByClassName(\"demo\");\r\n            if (currentSlideIndex > slides.length) {lsreportconfig.slideIndex = 1}\r\n            if (currentSlideIndex < 1) {lsreportconfig.slideIndex = slides.length}\r\n            for (i = 0; i < slides.length; i++) {\r\n                slides[i].style.display = \"none\";\r\n            }\r\n            slides[lsreportconfig.slideIndex-1].style.display = \"block\";\r\n            setTimeout(function(){\r\n                if (lsreportconfig.slideIndex >= slides.length) {\r\n                    lsreportconfig.currentSlide(1);\r\n                } else {\r\n                    lsreportconfig.lsreportslideshow(lsreportconfig.slideIndex++) ;\r\n                }\r\n            }, 3000);\r\n        },\r\n        lsconfigimportprogress: function(args){\r\n            var val = lsreportconfig.progressbar.progressbar( \"value\" ) || 0;\r\n            var total = args.total;\r\n            var current = args.current;\r\n            var errorreportspositiondata = args.errorreportspositiondata;\r\n            var lastreportposition = args.lastreportposition;\r\n            var promise = Ajax.call([{\r\n                methodname: 'block_learnerscript_importreports',\r\n                    args: {\r\n                        total: total,\r\n                        current: current,\r\n                        errorreportspositiondata: errorreportspositiondata,\r\n                        lastreportposition: lastreportposition\r\n                    },\r\n                }], false);\r\n            promise[0].done(function(response){\r\n                resp = $.parseJSON(response);\r\n                lsreportconfig.progressbar.progressbar(\"value\", resp.percent);\r\n                if(resp.percent < 100) {\r\n                    if(resp.current && resp.current > 0) {\r\n                        args.current = resp.current;\r\n                    } else {\r\n                        args.current = args.current + 1;\r\n                    }\r\n                    setTimeout(function(){\r\n                        lsreportconfig.lsconfigimportprogress(args);\r\n                    }, 500);\r\n                }\r\n            });\r\n        },\r\n        lsconfigresetprogress: function(step) {\r\n            var promise = Ajax.call([{\r\n                methodname: 'block_learnerscript_resetlsconfig',\r\n                    args: {\r\n                        step : step\r\n                    },\r\n                }], false);\r\n            promise[0].done(function(response){\r\n                resp = $.parseJSON(response);\r\n                lsreportconfig.progressbar.progressbar(\"value\", resp.percent);\r\n                if (resp.percent == 100) {\r\n                    window.location.href = M.cfg.wwwroot + '/blocks/learnerscript/lsconfig.php?import=1';\r\n                }\r\n                if (resp.percent < 100) {\r\n                    if (resp.next && resp.next > 0) {\r\n                        step = resp.next;\r\n                    }\r\n                    setTimeout(function(){\r\n                        lsreportconfig.lsconfigresetprogress(step);\r\n                    }, 500);\r\n                }\r\n            });\r\n        },\r\n        lsreportconfigimport: function (){\r\n            var promise = Ajax.call([{\r\n                methodname: 'block_learnerscript_lsreportconfigimport',\r\n                    args: {\r\n                    },\r\n                }]);\r\n            promise[0].done(function(response){\r\n                return \"Message from onbeforeunload handler\";\r\n            });\r\n        }\r\n    };\r\n    return {\r\n        init: function(args, status) {\r\n            lsreportconfig.progressbar.progressbar({\r\n                    value: false,\r\n                    change: function() {\r\n                    },\r\n                    complete: function() {\r\n                        $('#reportdashboardnav').show(500);\r\n                    }\r\n                });\r\n            if ($('.mySlides').length > 0) {\r\n                lsreportconfig.lsreportslideshow(1);\r\n            }\r\n            if (status == 'import') {\r\n                lsreportconfig.lsconfigimportprogress(args);\r\n            } else if (status == 'reset') {\r\n                lsreportconfig.lsconfigresetprogress(1);\r\n            }\r\n            window.onbeforeunload = lsreportconfig.lsreportconfigimport;\r\n        },\r\n    };\r\n});"],"names":["define","Ajax","$","lsreportconfig","slideIndex","currentSlide","currentSlideIndex","lsreportslideshow","progressbar","i","slides","document","getElementsByClassName","length","style","display","setTimeout","lsconfigimportprogress","args","total","current","errorreportspositiondata","lastreportposition","call","methodname","done","response","resp","parseJSON","percent","lsconfigresetprogress","step","window","location","href","M","cfg","wwwroot","next","lsreportconfigimport","init","status","value","change","complete","show","onbeforeunload"],"mappings":"AAAAA,4CAAO,CAAC,YACJ,SACA,aACD,SAASC,KAAMC,OACVC,eAAiB,CACjBC,WAAY,EACZC,aAAc,SAASC,mBACnBH,eAAeI,kBAAkBJ,eAAeC,WAAaE,oBAGjEE,YAAaN,EAAG,gBAEhBK,kBAAmB,SAASD,uBACpBG,EACAC,OAASC,SAASC,uBAAuB,YAClCD,SAASC,uBAAuB,YACvCN,kBAAoBI,OAAOG,SAASV,eAAeC,WAAa,GAChEE,kBAAoB,IAAIH,eAAeC,WAAaM,OAAOG,QAC1DJ,EAAI,EAAGA,EAAIC,OAAOG,OAAQJ,IAC3BC,OAAOD,GAAGK,MAAMC,QAAU,OAE9BL,OAAOP,eAAeC,WAAW,GAAGU,MAAMC,QAAU,QACpDC,YAAW,WACHb,eAAeC,YAAcM,OAAOG,OACpCV,eAAeE,aAAa,GAE5BF,eAAeI,kBAAkBJ,eAAeC,gBAErD,MAEPa,uBAAwB,SAASC,MACnBf,eAAeK,YAAYA,YAAa,aAC9CW,MAAQD,KAAKC,MACbC,QAAUF,KAAKE,QACfC,yBAA2BH,KAAKG,yBAChCC,mBAAqBJ,KAAKI,mBAChBrB,KAAKsB,KAAK,CAAC,CACrBC,WAAY,oCACRN,KAAM,CACFC,MAAOA,MACPC,QAASA,QACTC,yBAA0BA,yBAC1BC,mBAAoBA,uBAExB,GACA,GAAGG,MAAK,SAASC,UACrBC,KAAOzB,EAAE0B,UAAUF,UACnBvB,eAAeK,YAAYA,YAAY,QAASmB,KAAKE,SAClDF,KAAKE,QAAU,MACXF,KAAKP,SAAWO,KAAKP,QAAU,EAC9BF,KAAKE,QAAUO,KAAKP,QAEpBF,KAAKE,QAAUF,KAAKE,QAAU,EAElCJ,YAAW,WACPb,eAAec,uBAAuBC,QACvC,UAIfY,sBAAuB,SAASC,MACd9B,KAAKsB,KAAK,CAAC,CACrBC,WAAY,oCACRN,KAAM,CACFa,KAAOA,SAEX,GACA,GAAGN,MAAK,SAASC,UACrBC,KAAOzB,EAAE0B,UAAUF,UACnBvB,eAAeK,YAAYA,YAAY,QAASmB,KAAKE,SACjC,KAAhBF,KAAKE,UACLG,OAAOC,SAASC,KAAOC,EAAEC,IAAIC,QAAU,+CAEvCV,KAAKE,QAAU,MACXF,KAAKW,MAAQX,KAAKW,KAAO,IACzBP,KAAOJ,KAAKW,MAEhBtB,YAAW,WACPb,eAAe2B,sBAAsBC,QACtC,UAIfQ,qBAAsB,WACJtC,KAAKsB,KAAK,CAAC,CACrBC,WAAY,2CACRN,KAAM,MAGN,GAAGO,MAAK,SAASC,gBACd,iDAIZ,CACHc,KAAM,SAAStB,KAAMuB,QACjBtC,eAAeK,YAAYA,YAAY,CAC/BkC,OAAO,EACPC,OAAQ,aAERC,SAAU,WACN1C,EAAE,uBAAuB2C,KAAK,QAGtC3C,EAAE,aAAaW,OAAS,GACxBV,eAAeI,kBAAkB,GAEvB,UAAVkC,OACAtC,eAAec,uBAAuBC,MACrB,SAAVuB,QACPtC,eAAe2B,sBAAsB,GAEzCE,OAAOc,eAAiB3C,eAAeoC"}