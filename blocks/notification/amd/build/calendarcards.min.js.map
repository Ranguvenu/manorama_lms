{"version":3,"file":"calendarcards.min.js","sources":["../src/calendarcards.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n/**\r\n *\r\n * @module     block/Notification\r\n * @package    block_notification\r\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\ndefine([\r\n    'core/templates',\r\n    'core/ajax',\r\n    'jquery',\r\n], function (Templates, Ajax, $) {\r\n    var users;\r\n    return users = {\r\n        init: function (args) {\r\n            const calendar = document.getElementById('customcalendar');\r\n            // console.log(calendar);\r\n            // Generate and append date cards\r\n            var time = $('#time').val() * 1000;\r\n            // const d = new Date(time);\r\n            // console.log('firstd');\r\n            // console.log(d);\r\n            var year = $(\"#id_year\").val();\r\n            var month = $(\"#id_month\").val();\r\n            const months = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];\r\n            var monthname = months[parseInt(month) - 1].substring(0, 3);\r\n            var days = new Date(parseInt(year), parseInt(month), 0).getDate();\r\n            // console.log('seconddays');\r\n            // console.log(days);\r\n            var gsDayNames = [\r\n                'Sunday',\r\n                'Monday',\r\n                'Tuesday',\r\n                'Wednesday',\r\n                'Thursday',\r\n                'Friday',\r\n                'Saturday'\r\n            ];\r\n            for (let i = 1; i <= days; i++) {\r\n                const card = document.createElement('div');\r\n                card.classList.add('card');\r\n                card.textContent = i;\r\n                var newd = new Date(month + '/' + i + '/' + year);\r\n                console.log(newd);\r\n                console.log(year + '-' + month + '-' + i);\r\n                var day = gsDayNames[newd.getDay()];\r\n                console.log('dayvalue');\r\n                console.log(day);\r\n                // onclick=\"(function(e){ require(\\'block_notification/calendarcards\\').customCalendar({year:' + year + ',month:' + month + ',day:' + i + ',courseid:1,categoryid:0})})(event)\"\r\n                card.innerHTML = '<div class=\"datesinfo\"><a class=\"dateslink\" href=\"javascript:void(0)\" data-year=' + year + ' data-month= ' + month + ' data-day = ' + i + ' data-courseid=1 data-categoryid=0 ><div class=\"monthinfo\">' + monthname + '</div><div class=\"dateinfo\">' + i + '</div><div class=\"dayinfo\">' + day.substring(0, 3) + '</div></a><div>'\r\n                // console.log(card);\r\n                calendar.appendChild(card);\r\n            }\r\n            $(document).on('click', '.dateslink', function () {\r\n                $('.card').removeClass('active');\r\n                var parentfirst = $(this).parent();\r\n                var parentsecond = $(parentfirst).parent();\r\n                $(parentsecond).addClass('active');\r\n                console.log($(this).data());\r\n                users.customCalendar($(this).data());\r\n            });\r\n        },\r\n        customCalendar: function (params) {\r\n            // #ED396C\r\n            // $('.activehover').css(\"background-color\",'#ED396C');\r\n            var promise = Ajax.call([{\r\n                methodname: 'block_notification_calendar_details',\r\n                args: params\r\n            }]);\r\n            $(\"#customcalendardata\").empty();\r\n            promise[0].done(function (resp) {\r\n                console.log(resp['events']);\r\n                if (resp.events.length == 0) {\r\n                    $('#customcalendardata').html('<div class=\"text-center calendar_events attempt_text\"><h4>No Events Available on this Date.</></h4></div>');\r\n                } else {\r\n                    var data = Templates.render('block_notification/customcalendardata', { events: resp['events'] });\r\n                    data.then(function (html, js) {\r\n                        $('#customcalendardata').html(html);\r\n                    });\r\n                }\r\n\r\n            }).fail(function (ex) {\r\n                // do something with the exception\r\n                console.log(ex);\r\n            });\r\n        },\r\n        load: function () {\r\n            $(document).on('change', '#id_month , #id_year', function () {\r\n                $(\"#customcalendar\").empty();\r\n                new users.init();\r\n                var year = $(\"#id_year\").val();\r\n                var month = $(\"#id_month\").val();\r\n                var day = 1;\r\n                // if (day > 9) {\r\n                // var scrollval = day * 85;\r\n                // $('#customcalendar').animate({\r\n                //     scrollLeft: '+=' + parseInt(scrollval) + 'px'\r\n                // }, \"slow\");\r\n                // }    \r\n                let scrollWidth = $('#customcalendar').get(0).scrollWidth;\r\n                $('#customcalendar').animate({\r\n                    scrollLeft: '-=' + scrollWidth + 'px'\r\n                }, \"slow\");\r\n                const d = new Date();\r\n                var presentmonth = parseInt(d.getMonth()) + parseInt(1);\r\n                if (presentmonth == month) {\r\n                    day = $(\"input[name=day]\").val();\r\n                    if (day > 9) {\r\n                        var scrollval = day * 85;\r\n                        $('#customcalendar').animate({\r\n                            scrollLeft: '+=' + parseInt(scrollval) + 'px'\r\n                        }, \"slow\");\r\n                    }\r\n                }\r\n                const params = { year: year, month: month, day: day, courseid: 1, categoryid: 0 };\r\n                new users.customCalendar(params);\r\n                users.active(day);\r\n            });\r\n            var year = $(\"#id_year\").val();\r\n            var month = $(\"#id_month\").val();\r\n            var day = $(\"input[name=day]\").val();\r\n            if (day > 9) {\r\n                var scrollval = day * 85;\r\n                $('#customcalendar').animate({\r\n                    scrollLeft: '+=' + parseInt(scrollval) + 'px'\r\n                }, \"slow\");\r\n            }\r\n            users.active(parseInt(day));\r\n\r\n            const params = { year: parseInt(year), month: parseInt(month), day: parseInt(day), courseid: 1, categoryid: 0 };\r\n            new users.customCalendar(params);\r\n            $('.horizon-prev').click(function (e) {\r\n                e.preventDefault();\r\n                let currentScroll = $('#customcalendar').get(0).scrollLeft;\r\n                let scrollWidth = $('#customcalendar').get(0).scrollWidth;\r\n                $('#customcalendar').animate({\r\n                    scrollLeft: '-=300px'\r\n                }, \"slow\");\r\n            });\r\n            $('.horizon-next').click(function (e) {\r\n                e.preventDefault();\r\n                let currentScroll = $('#customcalendar').get(0).scrollLeft;\r\n                let scrollWidth = $('#customcalendar').get(0).scrollWidth;\r\n                $('#customcalendar').animate({\r\n                    scrollLeft: '+=300px'\r\n                }, \"slow\");\r\n            });\r\n        },\r\n        active: function (day) {\r\n            $(\".dateinfo\").each(function () {\r\n                var dateval = $(this).text();\r\n                if (dateval == day) {\r\n                    var parent = $(this).parent();\r\n                    var parent1 = parent.parent();\r\n                    var id = parent1.parent();\r\n                    $(id).addClass('active');\r\n                }\r\n            });\r\n        }\r\n    };\r\n});\r\n"],"names":["define","Templates","Ajax","$","users","init","args","calendar","document","getElementById","val","year","month","monthname","parseInt","substring","days","Date","getDate","gsDayNames","i","card","createElement","classList","add","textContent","newd","console","log","day","getDay","innerHTML","appendChild","on","removeClass","parentfirst","this","parent","parentsecond","addClass","data","customCalendar","params","promise","call","methodname","empty","done","resp","events","length","html","render","then","js","fail","ex","load","scrollWidth","get","animate","scrollLeft","d","getMonth","scrollval","courseid","categoryid","active","click","e","preventDefault","each","text","id"],"mappings":";;;;;;AAoBAA,0CAAO,CACH,iBACA,YACA,WACD,SAAUC,UAAWC,KAAMC,GAC1B,IAAIC,MACJ,OAAOA,MAAQ,CACXC,KAAM,SAAUC,MACZ,MAAMC,SAAWC,SAASC,eAAe,kBAG9BN,EAAE,SAASO,MAAtB,IAIIC,KAAOR,EAAE,YAAYO,MACrBE,MAAQT,EAAE,aAAaO,MAE3B,IAAIG,UADW,CAAC,UAAW,WAAY,QAAS,QAAS,MAAO,OAAQ,OAAQ,SAAU,YAAa,UAAW,WAAY,YACvGC,SAASF,OAAS,GAAGG,UAAU,EAAG,GACrDC,KAAO,IAAIC,KAAKH,SAASH,MAAOG,SAASF,OAAQ,GAAGM,UAGpDC,WAAa,CACb,SACA,SACA,UACA,YACA,WACA,SACA,YAEJ,IAAK,IAAIC,EAAI,EAAGA,GAAKJ,KAAMI,IAAK,CAC5B,MAAMC,KAAOb,SAASc,cAAc,OACpCD,KAAKE,UAAUC,IAAI,QACnBH,KAAKI,YAAcL,EACnB,IAAIM,KAAO,IAAIT,KAAKL,MAAQ,IAAMQ,EAAI,IAAMT,MAC5CgB,QAAQC,IAAIF,MACZC,QAAQC,IAAIjB,KAAO,IAAMC,MAAQ,IAAMQ,GACvC,IAAIS,IAAMV,WAAWO,KAAKI,UAC1BH,QAAQC,IAAI,YACZD,QAAQC,IAAIC,KAEZR,KAAKU,UAAY,mFAAqFpB,KAAO,gBAAkBC,MAAQ,eAAiBQ,EAAI,8DAAgEP,UAAY,+BAAiCO,EAAI,8BAAgCS,IAAId,UAAU,EAAG,GAAK,kBAEnUR,SAASyB,YAAYX,MAEzBlB,EAAEK,UAAUyB,GAAG,QAAS,cAAc,WAClC9B,EAAE,SAAS+B,YAAY,UACvB,IAAIC,YAAchC,EAAEiC,MAAMC,SACtBC,aAAenC,EAAEgC,aAAaE,SAClClC,EAAEmC,cAAcC,SAAS,UACzBZ,QAAQC,IAAIzB,EAAEiC,MAAMI,QACpBpC,MAAMqC,eAAetC,EAAEiC,MAAMI,YAGrCC,eAAgB,SAAUC,QAGtB,IAAIC,QAAUzC,KAAK0C,KAAK,CAAC,CACrBC,WAAY,sCACZvC,KAAMoC,UAEVvC,EAAE,uBAAuB2C,QACzBH,QAAQ,GAAGI,MAAK,SAAUC,OACtBrB,QAAQC,IAAIoB,KAAa,QACC,GAAtBA,KAAKC,OAAOC,QACZ/C,EAAE,uBAAuBgD,KAAK,6GAEnBlD,UAAUmD,OAAO,wCAAyC,CAAEH,OAAQD,KAAa,SACvFK,MAAK,SAAUF,KAAMG,IACtBnD,EAAE,uBAAuBgD,KAAKA,YAIvCI,MAAK,SAAUC,IAEd7B,QAAQC,IAAI4B,QAGpBC,KAAM,WACFtD,EAAEK,UAAUyB,GAAG,SAAU,wBAAwB,WAC7C9B,EAAE,mBAAmB2C,QACrB,IAAI1C,MAAMC,KACV,IAAIM,KAAOR,EAAE,YAAYO,MACrBE,MAAQT,EAAE,aAAaO,MACvBmB,IAAM,EAOV,IAAI6B,YAAcvD,EAAE,mBAAmBwD,IAAI,GAAGD,YAC9CvD,EAAE,mBAAmByD,QAAQ,CACzBC,WAAY,KAAOH,YAAc,MAClC,QACH,MAAMI,EAAI,IAAI7C,KAEd,GADmBH,SAASgD,EAAEC,YAAcjD,SAAS,IACjCF,QAChBiB,IAAM1B,EAAE,mBAAmBO,OACjB,EAAG,CACT,IAAIsD,UAAkB,GAANnC,IAChB1B,EAAE,mBAAmByD,QAAQ,CACzBC,WAAY,KAAO/C,SAASkD,WAAa,MAC1C,QAGX,MAAMtB,OAAS,CAAE/B,KAAMA,KAAMC,MAAOA,MAAOiB,IAAKA,IAAKoC,SAAU,EAAGC,WAAY,GAC9E,IAAI9D,MAAMqC,eAAeC,QACzBtC,MAAM+D,OAAOtC,QAEjB,IAAIlB,KAAOR,EAAE,YAAYO,MACrBE,MAAQT,EAAE,aAAaO,MACvBmB,IAAM1B,EAAE,mBAAmBO,MAC/B,GAAImB,IAAM,EAAG,CACT,IAAImC,UAAkB,GAANnC,IAChB1B,EAAE,mBAAmByD,QAAQ,CACzBC,WAAY,KAAO/C,SAASkD,WAAa,MAC1C,QAEP5D,MAAM+D,OAAOrD,SAASe,MAEtB,MAAMa,OAAS,CAAE/B,KAAMG,SAASH,MAAOC,MAAOE,SAASF,OAAQiB,IAAKf,SAASe,KAAMoC,SAAU,EAAGC,WAAY,GAC5G,IAAI9D,MAAMqC,eAAeC,QACzBvC,EAAE,iBAAiBiE,OAAM,SAAUC,GAC/BA,EAAEC,iBACkBnE,EAAE,mBAAmBwD,IAAI,GAAGE,WAC9B1D,EAAE,mBAAmBwD,IAAI,GAAGD,YAC9CvD,EAAE,mBAAmByD,QAAQ,CACzBC,WAAY,WACb,WAEP1D,EAAE,iBAAiBiE,OAAM,SAAUC,GAC/BA,EAAEC,iBACkBnE,EAAE,mBAAmBwD,IAAI,GAAGE,WAC9B1D,EAAE,mBAAmBwD,IAAI,GAAGD,YAC9CvD,EAAE,mBAAmByD,QAAQ,CACzBC,WAAY,WACb,YAGXM,OAAQ,SAAUtC,KACd1B,EAAE,aAAaoE,MAAK,WAEhB,GADcpE,EAAEiC,MAAMoC,QACP3C,IAAK,CAChB,IAEI4C,GAFStE,EAAEiC,MAAMC,SACAA,SACJA,SACjBlC,EAAEsE,IAAIlC,SAAS,eAKnC"}