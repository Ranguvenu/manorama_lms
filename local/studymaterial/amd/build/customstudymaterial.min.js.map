{"version":3,"file":"customstudymaterial.min.js","sources":["../src/customstudymaterial.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * AMD module for the hirarchy in studymaterial page.\n *\n * @module     local_studymaterial/customstudymaterial\n * @copyright  2023 Moodle India\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nimport ModalForm from 'core_form/modalform';\nimport ModalFactory from 'core/modal_factory';\nimport ModalEvents from 'core/modal_events';\nimport Ajax from 'core/ajax';\nimport Notification from 'core/notification';\nimport Templates from 'core/templates';\nimport { get_string as getString } from 'core/str';\nimport homepage from 'theme_horizon/homepage';\n\n/**\n * Selectors\n */\nconst Selectors = {\n    actions: {\n        createstudymaterial: '[data-action = \"createstudymaterial\"]',\n        deletestudymaterial: '[data-action=\"deletestudymaterial\"]',\n    },\n};\n\n/**\n * Initialize module\n */\nlet HomePage = new homepage();\nexport const init = () => {\n    document.addEventListener('click', function (e) {\n        let createstudymaterial = e.target.closest(Selectors.actions.createstudymaterial);\n        if (createstudymaterial) {\n            e.preventDefault();\n            e.stopImmediatePropagation();\n            const title = createstudymaterial.getAttribute('data-id') ?\n                getString('edit_studymaterial', 'local_studymaterial', createstudymaterial.getAttribute('data-name')) :\n                getString('add_studymaterial', 'local_studymaterial');\n            const form = new ModalForm({\n                formClass: 'local_studymaterial\\\\form\\\\customstudymaterial',\n                args: { id: createstudymaterial.getAttribute('data-id'),courseid: createstudymaterial.getAttribute('data-courseid') },\n                modalConfig: { title },\n                returnFocus: createstudymaterial,\n            });\n            form.addEventListener(form.events.FORM_SUBMITTED, () => window.location.reload());\n            form.show();\n        }\n        deletestudymaterial = e.target.closest(Selectors.actions.deletestudymaterial);\n        if (deletestudymaterial) {\n            const component = deletestudymaterial.getAttribute('data-component');\n            const id = deletestudymaterial.getAttribute('data-id');\n            const name = deletestudymaterial.getAttribute('data-name');\n            const code = deletestudymaterial.getAttribute('data-code');\n            var displayparams = {};\n            displayparams.component = component;\n            displayparams.name = name;\n            displayparams.code = code;\n            ModalFactory.create({\n                title: getString('deletestudymaterialconfirm', 'local_studymaterial', component),\n                type: ModalFactory.types.SAVE_CANCEL,\n                body: getString('deletestudymaterialbodymessage', 'local_studymaterial', displayparams)\n            }).done(function (modal) {\n                this.modal = modal;\n                modal.setSaveButtonText(getString('deletetext', 'local_studymaterial'));\n                modal.getRoot().on(ModalEvents.save, function (e) {\n                    e.preventDefault();\n                    var params = {};\n                    params.id = id;\n                    var promise = Ajax.call([{\n                        methodname: 'local_studymaterial_deletestudymaterial',\n                        args: params\n                    }]);\n                    promise[0].done(function (resp) {\n                        window.location.reload(true);\n                    }).fail(function () {\n                        // do something with the exception\n                        console.log('exception');\n                    });\n\n\n                }.bind(this));\n                modal.show();\n            }.bind(this));\n        }\n    });\n};\n"],"names":["Selectors","createstudymaterial","deletestudymaterial","homepage","document","addEventListener","e","target","closest","preventDefault","stopImmediatePropagation","title","getAttribute","form","ModalForm","formClass","args","id","courseid","modalConfig","returnFocus","events","FORM_SUBMITTED","window","location","reload","show","component","name","code","displayparams","create","type","ModalFactory","types","SAVE_CANCEL","body","done","modal","setSaveButtonText","getRoot","on","ModalEvents","save","params","Ajax","call","methodname","resp","fail","console","log","bind","this"],"mappings":";;;;;;;kaAkCMA,kBACO,CACLC,oBAAqB,wCACrBC,oBAAqB,uCAOd,IAAIC,gCACC,KAChBC,SAASC,iBAAiB,SAAS,SAAUC,OACrCL,oBAAsBK,EAAEC,OAAOC,QAAQR,kBAAkBC,wBACzDA,oBAAqB,CACrBK,EAAEG,iBACFH,EAAEI,iCACIC,MAAQV,oBAAoBW,aAAa,YAC3C,mBAAU,qBAAsB,sBAAuBX,oBAAoBW,aAAa,eACxF,mBAAU,oBAAqB,uBAC7BC,KAAO,IAAIC,mBAAU,CACvBC,UAAW,iDACXC,KAAM,CAAEC,GAAIhB,oBAAoBW,aAAa,WAAWM,SAAUjB,oBAAoBW,aAAa,kBACnGO,YAAa,CAAER,MAAAA,OACfS,YAAanB,sBAEjBY,KAAKR,iBAAiBQ,KAAKQ,OAAOC,gBAAgB,IAAMC,OAAOC,SAASC,WACxEZ,KAAKa,UAETxB,oBAAsBI,EAAEC,OAAOC,QAAQR,kBAAkBE,qBACrDA,oBAAqB,OACfyB,UAAYzB,oBAAoBU,aAAa,kBAC7CK,GAAKf,oBAAoBU,aAAa,WACtCgB,KAAO1B,oBAAoBU,aAAa,aACxCiB,KAAO3B,oBAAoBU,aAAa,iBAC1CkB,cAAgB,GACpBA,cAAcH,UAAYA,UAC1BG,cAAcF,KAAOA,KACrBE,cAAcD,KAAOA,4BACRE,OAAO,CAChBpB,OAAO,mBAAU,6BAA8B,sBAAuBgB,WACtEK,KAAMC,uBAAaC,MAAMC,YACzBC,MAAM,mBAAU,iCAAkC,sBAAuBN,iBAC1EO,KAAK,SAAUC,YACTA,MAAQA,MACbA,MAAMC,mBAAkB,mBAAU,aAAc,wBAChDD,MAAME,UAAUC,GAAGC,sBAAYC,KAAM,SAAUrC,GAC3CA,EAAEG,qBACEmC,OAAS,GACbA,OAAO3B,GAAKA,GACE4B,cAAKC,KAAK,CAAC,CACrBC,WAAY,0CACZ/B,KAAM4B,UAEF,GAAGP,MAAK,SAAUW,MACtBzB,OAAOC,SAASC,QAAO,MACxBwB,MAAK,WAEJC,QAAQC,IAAI,iBAIlBC,KAAKC,OACPf,MAAMZ,QACR0B,KAAKC"}