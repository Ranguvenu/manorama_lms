define("local_goals/customgoals",["exports","core_form/modalform","core/modal_factory","core/modal_events","core/ajax","core/notification","core/templates","core/str","theme_horizon/homepage"],(function(_exports,_modalform,_modal_factory,_modal_events,_ajax,_notification,_templates,_str,_homepage){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * AMD module for the hirarchy in goals page.
   *
   * @module     local_goals/customgoals
   * @copyright  2023 Moodle India
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_modalform=_interopRequireDefault(_modalform),_modal_factory=_interopRequireDefault(_modal_factory),_modal_events=_interopRequireDefault(_modal_events),_ajax=_interopRequireDefault(_ajax),_notification=_interopRequireDefault(_notification),_templates=_interopRequireDefault(_templates),_homepage=_interopRequireDefault(_homepage);const Selectors_actions={creategoal:'[data-action = "creategoal"]',createboard:'[data-action="createboard"]',createclass:'[data-action="createclass"]',createsubject:'[data-action="createsubject"]',deletecomponent:'[data-action="deletecomponent"]'};let HomePage=new _homepage.default;_exports.init=()=>{document.addEventListener("click",(function(e){let creategoal=e.target.closest(Selectors_actions.creategoal);if(creategoal){e.preventDefault(),e.stopImmediatePropagation();const title=creategoal.getAttribute("data-id")?(0,_str.get_string)("edit_goal","local_goals",creategoal.getAttribute("data-name")):(0,_str.get_string)("add_goal","local_goals"),form=new _modalform.default({formClass:"local_goals\\form\\customgoal",args:{id:creategoal.getAttribute("data-id")},modalConfig:{title:title},returnFocus:creategoal});form.addEventListener(form.events.FORM_SUBMITTED,(()=>window.location.reload())),form.show()}if(createboard=e.target.closest(Selectors_actions.createboard),createboard){e.preventDefault(),e.stopImmediatePropagation();const title=createboard.getAttribute("data-id")?(0,_str.get_string)("edit_board","local_goals",createboard.getAttribute("data-name")):(0,_str.get_string)("add_board","local_goals",createboard.getAttribute("data-goalname")),form=new _modalform.default({formClass:"local_goals\\form\\customboard",args:{id:createboard.getAttribute("data-id"),goalid:createboard.getAttribute("data-goalid")},modalConfig:{title:title},returnFocus:createboard});form.addEventListener(form.events.FORM_SUBMITTED,(()=>window.location.reload())),form.show()}if(createclass=e.target.closest(Selectors_actions.createclass),createclass){e.preventDefault(),e.stopImmediatePropagation();const title=createclass.getAttribute("data-id")?(0,_str.get_string)("edit_class","local_goals",createclass.getAttribute("data-name")):(0,_str.get_string)("add_class","local_goals",createclass.getAttribute("data-boardname")),form=new _modalform.default({formClass:"local_goals\\form\\customclass",args:{id:createclass.getAttribute("data-id"),boardid:createclass.getAttribute("data-boardid")},modalConfig:{title:title},returnFocus:createclass});form.addEventListener(form.events.FORM_SUBMITTED,(()=>window.location.reload())),form.show()}if(createsubject=e.target.closest(Selectors_actions.createsubject),createsubject){e.preventDefault(),e.stopImmediatePropagation();const title=createsubject.getAttribute("data-id")?(0,_str.get_string)("edit_subject","local_goals",createsubject.getAttribute("data-name")):(0,_str.get_string)("add_subject","local_goals",createsubject.getAttribute("data-classessname")),form=new _modalform.default({formClass:"local_goals\\form\\customsubject",args:{id:createsubject.getAttribute("data-id"),classessid:createsubject.getAttribute("data-classessid")},modalConfig:{title:title},returnFocus:createsubject});form.addEventListener(form.events.FORM_SUBMITTED,(()=>window.location.reload())),form.show()}if(deletecomponent=e.target.closest(Selectors_actions.deletecomponent),deletecomponent){const component=deletecomponent.getAttribute("data-component"),id=deletecomponent.getAttribute("data-id"),name=deletecomponent.getAttribute("data-name"),code=deletecomponent.getAttribute("data-code");var displayparams={};displayparams.component=component,displayparams.name=name,displayparams.code=code,_modal_factory.default.create({title:(0,_str.get_string)("deletecomponentconfirm","local_goals",component),type:_modal_factory.default.types.SAVE_CANCEL,body:(0,_str.get_string)("deletecomponentbodymessage","local_goals",displayparams)}).done(function(modal){this.modal=modal,modal.setSaveButtonText((0,_str.get_string)("deletetext","local_goals")),modal.getRoot().on(_modal_events.default.save,function(e){e.preventDefault();var sparams={};sparams.id=id,sparams.component=component,_ajax.default.call([{methodname:"local_goals_candeletecomponent",args:sparams}])[0].done((function(resp){if(1==resp.candelete)modal.hide(),HomePage.confirmbox((0,_str.get_string)("remove_dependency","local_goals"));else{var params={};params.id=id,params.component=component,_ajax.default.call([{methodname:"local_goals_deletecomponent",args:params}])[0].done((function(resp){window.location.reload(!0)})).fail((function(){console.log("exception")}))}})).fail((function(){console.log("exception")}))}.bind(this)),modal.show()}.bind(this))}}))}}));

//# sourceMappingURL=customgoals.min.js.map