{"version":3,"file":"faqform.min.js","sources":["../src/faqform.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * AMD module for the hirarchy in faqs page.\n *\n * @module     local_faq/faq_categories\n * @copyright  2023 Moodle India\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nimport ModalForm from 'core_form/modalform';\nimport ModalFactory from 'core/modal_factory';\nimport ModalEvents from 'core/modal_events';\nimport Ajax from 'core/ajax';\nimport Notification from 'core/notification';\nimport Templates from 'core/templates';\nimport {get_string as getString} from 'core/str';\nimport homepage from 'theme_horizon/homepage';\n\n/**\n * Selectors\n */\nconst Selectors = {\n    actions: {\n        cteatecategory: '[data-action = \"cteatecategory\"]',\n        cteatequeries: '[data-action=\"cteatequeries\"]',\n        createclass: '[data-action=\"createclass\"]',\n        createsubject: '[data-action=\"createsubject\"]',\n        deletefaq: '[data-action=\"deletefaq\"]',\n        deletequery: '[data-action=\"deletequery\"]',\n    },\n};\n\n/**\n * Initialize module\n */\nlet HomePage = new homepage();\nexport const init = () => {\n    document.addEventListener('click', function(e) {\n        let cteatecategory = e.target.closest(Selectors.actions.cteatecategory);\n        if (cteatecategory) {\n            e.preventDefault();\n            e.stopImmediatePropagation();\n            const title = cteatecategory.getAttribute('data-id') ?\n                getString('edit_faqcategory', 'local_faq', cteatecategory.getAttribute('data-name')) :\n                getString('addcategory', 'local_faq');\n            const form = new ModalForm({\n                formClass: 'local_faq\\\\form\\\\faq_categories',\n                args: {id: cteatecategory.getAttribute('data-id')},\n                modalConfig: {title},\n                returnFocus: cteatecategory,\n            });\n            form.addEventListener(form.events.FORM_SUBMITTED, () => window.location.reload());\n            form.show();\n        }\n        cteatequeries = e.target.closest(Selectors.actions.cteatequeries);\n        if (cteatequeries) {\n            e.preventDefault();\n            e.stopImmediatePropagation();\n            const title = cteatequeries.getAttribute('data-id') ?\n                getString('edit_faqquery', 'local_faq', cteatequeries.getAttribute('data-name')) :\n                getString('addquery', 'local_faq', cteatequeries.getAttribute('data-name'));\n            const form = new ModalForm({\n                formClass: 'local_faq\\\\form\\\\faq_queries',\n                args: {id: cteatequeries.getAttribute('data-id'),id: cteatequeries.getAttribute('data-id')},\n                modalConfig: {title},\n                returnFocus: cteatequeries,\n            });\n            form.addEventListener(form.events.FORM_SUBMITTED, () => window.location.reload());\n            form.show();\n        }\n        createclass = e.target.closest(Selectors.actions.createclass);\n        if (createclass) {\n            e.preventDefault();\n            e.stopImmediatePropagation();\n            const title = createclass.getAttribute('data-id') ?\n                getString('edit_class', 'local_faq', createclass.getAttribute('data-name')) :\n                getString('add_class', 'local_faq', createclass.getAttribute('data-boardname'));\n        \n            const form = new ModalForm({\n                formClass: 'local_faq\\\\form\\\\customclass',\n                args: {id: createclass.getAttribute('data-id'),boardid: createclass.getAttribute('data-boardid')},\n                modalConfig: {title},\n                returnFocus: createclass,\n            });\n            form.addEventListener(form.events.FORM_SUBMITTED, () => window.location.reload());\n            form.show();\n        }\n        createsubject = e.target.closest(Selectors.actions.createsubject);\n        if (createsubject) {\n            e.preventDefault();\n            e.stopImmediatePropagation();\n            const title = createsubject.getAttribute('data-id') ?\n                getString('edit_subject', 'local_faq', createsubject.getAttribute('data-name')) :\n                getString('add_subject', 'local_faq', createsubject.getAttribute('data-classessname'));\n        \n            const form = new ModalForm({\n                formClass: 'local_faq\\\\form\\\\customsubject',\n                args: {id: createsubject.getAttribute('data-id'),classessid: createsubject.getAttribute('data-classessid')},\n                modalConfig: {title},\n                returnFocus: createsubject,\n            });\n            form.addEventListener(form.events.FORM_SUBMITTED, () => window.location.reload());\n            form.show();\n        }\n\n        let deletefaq = e.target.closest(Selectors.actions.deletefaq);\n        if (deletefaq) {\n          const id = deletefaq.getAttribute(\"data-id\");\n          const name = deletefaq.getAttribute(\"data-name\");\n          ModalFactory.create({\n            title: getString(\"confirm\", \"local_faq\"),\n            type: ModalFactory.types.SAVE_CANCEL,\n            body: getString(\"deletefaqcategory\", \"local_faq\", name),\n          }).done(\n            function (modal) {\n              this.modal = modal;\n              modal.setSaveButtonText(getString(\"yes\", \"local_faq\"));\n              modal.getRoot().on(\n                ModalEvents.save,\n                function (e) {\n                  e.preventDefault();\n                  var params = {};\n                  params.confirm = true;\n                  params.id = id;\n                  var promise = Ajax.call([\n                    {\n                      methodname: \"local_faq_delete_faqcategory\",\n                      args: params,\n                    },\n                  ]);\n                  promise[0]\n                    .done(function () {\n                      window.location.reload(true);\n                    })\n                    .fail(function () {\n                      // do something with the exception\n                    });\n                }.bind(this)\n              );\n              modal.show();\n            }.bind(this)\n          );\n        }\n        let deletequery = e.target.closest(Selectors.actions.deletequery);\n        if (deletequery) {\n          const id = deletequery.getAttribute(\"data-id\");\n          const name = deletequery.getAttribute(\"data-name\");\n          ModalFactory.create({\n            title: getString(\"confirm\", \"local_faq\"),\n            type: ModalFactory.types.SAVE_CANCEL,\n            body: getString(\"deletefaqquery\", \"local_faq\", name),\n          }).done(\n            function (modal) {\n              this.modal = modal;\n              modal.setSaveButtonText(getString(\"yes\", \"local_faq\"));\n              modal.getRoot().on(\n                ModalEvents.save,\n                function (e) {\n                  e.preventDefault();\n                  var params = {};\n                  params.confirm = true;\n                  params.id = id;\n                  var promise = Ajax.call([\n                    {\n                      methodname: \"local_faq_delete_faq_query\",\n                      args: params,\n                    },\n                  ]);\n                  promise[0]\n                    .done(function () {\n                      window.location.reload(true);\n                    })\n                    .fail(function () {\n                      // do something with the exception\n                    });\n                }.bind(this)\n              );\n              modal.show();\n            }.bind(this)\n          );\n        }\n    });\n};\n"],"names":["Selectors","cteatecategory","cteatequeries","createclass","createsubject","deletefaq","deletequery","homepage","document","addEventListener","e","target","closest","preventDefault","stopImmediatePropagation","title","getAttribute","form","ModalForm","formClass","args","id","modalConfig","returnFocus","events","FORM_SUBMITTED","window","location","reload","show","boardid","classessid","name","create","type","ModalFactory","types","SAVE_CANCEL","body","done","modal","setSaveButtonText","getRoot","on","ModalEvents","save","params","Ajax","call","methodname","fail","bind","this"],"mappings":"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"}