define("local_units/customunits",["exports","core_form/modalform","core/modal_factory","core/modal_events","core/ajax","core/notification","core/templates","core/str","theme_horizon/homepage"],(function(_exports,_modalform,_modal_factory,_modal_events,_ajax,_notification,_templates,_str,_homepage){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * AMD module for the hirarchy in units page.
   *
   * @module     local_units/customunits
   * @copyright  2023 Moodle India
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_modalform=_interopRequireDefault(_modalform),_modal_factory=_interopRequireDefault(_modal_factory),_modal_events=_interopRequireDefault(_modal_events),_ajax=_interopRequireDefault(_ajax),_notification=_interopRequireDefault(_notification),_templates=_interopRequireDefault(_templates),_homepage=_interopRequireDefault(_homepage);const Selectors_actions={createunit:'[data-action = "createunit"]',createchapter:'[data-action="createchapter"]',createtopic:'[data-action="createtopic"]',createconcept:'[data-action="createconcept"]',deletecomponent:'[data-action="deletecomponent"]'};let HomePage=new _homepage.default;_exports.init=()=>{document.addEventListener("click",(function(e){let createunit=e.target.closest(Selectors_actions.createunit);if(createunit){e.preventDefault(),e.stopImmediatePropagation();const title=createunit.getAttribute("data-id")?(0,_str.get_string)("edit_unit","local_units",createunit.getAttribute("data-name")):(0,_str.get_string)("add_unit","local_units"),form=new _modalform.default({formClass:"local_units\\form\\customunit",args:{id:createunit.getAttribute("data-id")},modalConfig:{title:title},returnFocus:createunit});form.addEventListener(form.events.FORM_SUBMITTED,(()=>window.location.reload())),form.show()}if(createchapter=e.target.closest(Selectors_actions.createchapter),createchapter){e.preventDefault(),e.stopImmediatePropagation();const title=createchapter.getAttribute("data-id")?(0,_str.get_string)("edit_chapter","local_units",createchapter.getAttribute("data-name")):(0,_str.get_string)("add_chapter","local_units",createchapter.getAttribute("data-unitname")),form=new _modalform.default({formClass:"local_units\\form\\customchapter",args:{id:createchapter.getAttribute("data-id"),unitid:createchapter.getAttribute("data-unitid")},modalConfig:{title:title},returnFocus:createchapter});form.addEventListener(form.events.FORM_SUBMITTED,(()=>window.location.reload())),form.show()}if(createtopic=e.target.closest(Selectors_actions.createtopic),createtopic){e.preventDefault(),e.stopImmediatePropagation();const title=createtopic.getAttribute("data-id")?(0,_str.get_string)("edit_topic","local_units",createtopic.getAttribute("data-name")):(0,_str.get_string)("add_topic","local_units",createtopic.getAttribute("data-chaptername")),form=new _modalform.default({formClass:"local_units\\form\\customtopic",args:{id:createtopic.getAttribute("data-id"),chapterid:createtopic.getAttribute("data-chapterid"),unitid:createtopic.getAttribute("data-unitid")},modalConfig:{title:title},returnFocus:createtopic});form.addEventListener(form.events.FORM_SUBMITTED,(()=>window.location.reload())),form.show()}if(createconcept=e.target.closest(Selectors_actions.createconcept),createconcept){e.preventDefault(),e.stopImmediatePropagation();const title=createconcept.getAttribute("data-id")?(0,_str.get_string)("edit_concept","local_units",createconcept.getAttribute("data-name")):(0,_str.get_string)("add_concept","local_units",createconcept.getAttribute("data-conceptname")),form=new _modalform.default({formClass:"local_units\\form\\customconcept",args:{id:createconcept.getAttribute("data-id"),chapterid:createconcept.getAttribute("data-chapterid"),unitid:createconcept.getAttribute("data-unitid"),topicid:createconcept.getAttribute("data-topicid")},modalConfig:{title:title},returnFocus:createconcept});form.addEventListener(form.events.FORM_SUBMITTED,(()=>window.location.reload())),form.show()}if(deletecomponent=e.target.closest(Selectors_actions.deletecomponent),deletecomponent){const component=deletecomponent.getAttribute("data-component"),id=deletecomponent.getAttribute("data-id"),name=deletecomponent.getAttribute("data-name"),code=deletecomponent.getAttribute("data-code");var displayparams={};displayparams.component=component,displayparams.name=name,displayparams.code=code,_modal_factory.default.create({title:(0,_str.get_string)("deletecomponentconfirm","local_units",component),type:_modal_factory.default.types.SAVE_CANCEL,body:(0,_str.get_string)("deletecomponentbodymessage","local_units",displayparams)}).done(function(modal){this.modal=modal,modal.setSaveButtonText((0,_str.get_string)("deletetext","local_units")),modal.getRoot().on(_modal_events.default.save,function(e){e.preventDefault();var sparams={};sparams.id=id,sparams.component=component,_ajax.default.call([{methodname:"local_units_candeletecomponent",args:sparams}])[0].done((function(resp){if(1==resp.candelete)modal.hide(),HomePage.confirmbox((0,_str.get_string)("remove_dependency","local_units"));else{var params={};params.id=id,params.component=component,_ajax.default.call([{methodname:"local_units_deletecomponent",args:params}])[0].done((function(resp){window.location.reload(!0)})).fail((function(){console.log("exception")}))}})).fail((function(){console.log("exception")}))}.bind(this)),modal.show()}.bind(this))}}))}}));

//# sourceMappingURL=customunits.min.js.map