define("local_packages/session",["exports","core_form/modalform","core/modal_factory","core/modal_events","core/ajax","core/templates","core/str"],(function(_exports,_modalform,_modal_factory,_modal_events,_ajax,_templates,_str){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * TODO describe module session
   *
   * @module     local_packages/session
   * @copyright  2023 YOUR NAME <your@email.com>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_modalform=_interopRequireDefault(_modalform),_modal_factory=_interopRequireDefault(_modal_factory),_modal_events=_interopRequireDefault(_modal_events),_ajax=_interopRequireDefault(_ajax),_templates=_interopRequireDefault(_templates);const Selectors_actions={addsessions:'[data-action="addsessions"]',viewsessions:'[data-action="viewsessions"]',deletesession:'[data-action="deletesession"]'};_exports.init=()=>{document.addEventListener("click",(function(e){let element=e.target.closest(Selectors_actions.addsessions);if(element){e.preventDefault(),e.stopImmediatePropagation();const title=element.getAttribute("data-id")?(0,_str.get_string)("updatesession","local_packages"):(0,_str.get_string)("addsession","local_packages"),form=new _modalform.default({formClass:"local_packages\\form\\session_form",args:{id:element.getAttribute("data-id"),packageid:element.getAttribute("data-packageid"),courseid:element.getAttribute("data-courseid")},modalConfig:{title:title},returnFocus:element});form.addEventListener(form.events.FORM_SUBMITTED,(event=>{event.preventDefault(),e.preventDefault(),_templates.default.renderForPromise("local_packages/loader",{}).then((_ref2=>{let{html:html,js:js}=_ref2;_templates.default.appendNodeContents(".modal-content",html,js)})),window.location.reload()})),form.show()}let viewsessions=e.target.closest(Selectors_actions.viewsessions);if(viewsessions){e.preventDefault(),e.stopImmediatePropagation();const packageid=viewsessions.getAttribute("data-packageid"),courseid=viewsessions.getAttribute("data-courseid"),coursename=viewsessions.getAttribute("data-coursename");var options={};options.packageid=packageid,options.courseid=courseid;var trigger=$(Selectors_actions.viewsessions);_modal_factory.default.create({title:(0,_str.get_string)("viewcoursesessions","local_packages",coursename),body:_templates.default.render("local_packages/sessions_display",options)},trigger).done((function(modal){modal.setLarge(),modal.show(),modal.getRoot().on(_modal_events.default.hidden,function(){modal.destroy()}.bind(this))}))}let deletesession=e.target.closest(Selectors_actions.deletesession);if(deletesession){e.preventDefault();const id=deletesession.getAttribute("data-id"),batchname=deletesession.getAttribute("data-batchname"),schedulecode=deletesession.getAttribute("data-schedulecode");var displayparams={};displayparams.batchname=batchname,displayparams.schedulecode=schedulecode,_modal_factory.default.create({title:(0,_str.get_string)("deleteconfirm","local_packages"),type:_modal_factory.default.types.SAVE_CANCEL,body:(0,_str.get_string)("sessiondeletebodymessage","local_packages",displayparams)}).done(function(modal){this.modal=modal,modal.setSaveButtonText((0,_str.get_string)("deletetext","local_packages")),modal.getRoot().on(_modal_events.default.save,function(e){e.preventDefault(),_templates.default.renderForPromise("local_packages/loader",{}).then((_ref3=>{let{html:html,js:js}=_ref3;_templates.default.appendNodeContents(".modal-content",html,js)}));var params={};params.id=id,_ajax.default.call([{methodname:"local_packages_deletesession",args:params}])[0].done((function(resp){window.location.reload(!0)})).fail((function(){console.log("exception")}))}.bind(this)),modal.show()}.bind(this))}}))}}));

//# sourceMappingURL=session.min.js.map