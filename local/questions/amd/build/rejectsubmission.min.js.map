{"version":3,"file":"rejectsubmission.min.js","sources":["../src/rejectsubmission.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Functionality for questions\n *\n * @module     local_questions/questions\n * @package\n * @copyright  2023 Moodle India Information Solutions Pvt Ltd\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nimport $ from 'jquery';\nimport ModalForm from 'core_form/modalform';\nimport ModalFactory from 'core/modal_factory';\nimport ModalEvents from 'core/modal_events';\nimport Ajax from 'core/ajax';\nimport {get_string as getString} from 'core/str';\n\nconst SELECTORS = {\n    REJECTSUBMISSION: '[data-action=\"statustoreject\"]',\n};\n\n/**\n* Displays a modal form to create question types\n*\n* @param {Event} e\n*/\nconst rejectReasonSubmission = function(e) {\n    e.preventDefault();\n    var id = $(e.currentTarget).attr('data-id');\n    var headstring = $(e.currentTarget).attr('data-headstring');\n    var qbankeid = $(e.currentTarget).attr('data-qbankeid');\n    var workshopid = $(e.currentTarget).attr('data-wid');\n\n    var modal = new ModalForm({\n        formClass: 'local_questions\\\\form\\\\rejectreason_form',\n        args: {id: id, qbankeid: qbankeid, workshopid: workshopid},\n        modalConfig: {title: headstring},\n        saveButtonText: getString('save'),\n        returnFocus: $(e.currentTarget),\n    });\n    modal.addEventListener(modal.events.FORM_SUBMITTED, function() {\n    \tvar qid = $(e.currentTarget).attr('data-id');\n\tvar wid = $(e.currentTarget).attr('data-wid');\n\tvar status = $(e.currentTarget).attr('data-value');\n        var statusText = $(e.currentTarget).attr('data-statusText');\n        var adminstatus = $(e.currentTarget).attr('data-adminstatus');\n    \tvar params = {};\n\t    params.questionid = qid;\n\t    params.workshopid = wid;\n\t    params.status = status;\n\n        var promise = Ajax.call([{\n            methodname: 'local_questions_changequestionstatus',\n            args: params\n        }]);\n        promise[0].done(function(resp) {\n            $('.questioncreation_page #status_span'+qid).text(statusText);\n            if (status == 'reject' && adminstatus == 1) {\n                $('#understatus'+qid).hide();\n                $('#rejectstatus'+qid).hide();\n                $('#publishstatus'+qid).hide();\n                $('#raedystatus'+qid).hide();\n                $('#draftstatus'+qid).show();\n                $('#hideeditdelete'+qid).show();\n            }\n            if (status == 'reject' && adminstatus != 1) {\n                $('#understatus'+qid).hide();\n                $('#rejectstatus'+qid).hide();\n                $('#publishstatus'+qid).hide();\n                $('#draftstatus'+qid).show();\n            }\n        \tconsole.log('Status changed successfully');\n        }).fail(function() {\n        \tconsole.log('Error processing the request');\n        });\n        // window.location.reload();\n    });\n    modal.show();\n};\n\n/**\n * Initialise organization actions\n */\nexport const init = () => {\n\t$(SELECTORS.REJECTSUBMISSION).on('click', function(e) {\n        e.preventDefault();\n        rejectReasonSubmission(e);\n    });\n}\n"],"names":["SELECTORS","on","e","preventDefault","id","currentTarget","attr","headstring","qbankeid","workshopid","modal","ModalForm","formClass","args","modalConfig","title","saveButtonText","returnFocus","addEventListener","events","FORM_SUBMITTED","qid","wid","status","statusText","adminstatus","params","questionid","Ajax","call","methodname","done","resp","text","hide","show","console","log","fail","rejectReasonSubmission"],"mappings":";;;;;;;;4TA8BMA,2BACgB,+CAiEF,yBACjBA,4BAA4BC,GAAG,SAAS,SAASC,GAC5CA,EAAEC,iBA3DqB,SAASD,GACpCA,EAAEC,qBACEC,IAAK,mBAAEF,EAAEG,eAAeC,KAAK,WAC7BC,YAAa,mBAAEL,EAAEG,eAAeC,KAAK,mBACrCE,UAAW,mBAAEN,EAAEG,eAAeC,KAAK,iBACnCG,YAAa,mBAAEP,EAAEG,eAAeC,KAAK,YAErCI,MAAQ,IAAIC,mBAAU,CACtBC,UAAW,2CACXC,KAAM,CAACT,GAAIA,GAAII,SAAUA,SAAUC,WAAYA,YAC/CK,YAAa,CAACC,MAAOR,YACrBS,gBAAgB,mBAAU,QAC1BC,aAAa,mBAAEf,EAAEG,iBAErBK,MAAMQ,iBAAiBR,MAAMS,OAAOC,gBAAgB,eAC/CC,KAAM,mBAAEnB,EAAEG,eAAeC,KAAK,WAClCgB,KAAM,mBAAEpB,EAAEG,eAAeC,KAAK,YAC9BiB,QAAS,mBAAErB,EAAEG,eAAeC,KAAK,cAC1BkB,YAAa,mBAAEtB,EAAEG,eAAeC,KAAK,mBACrCmB,aAAc,mBAAEvB,EAAEG,eAAeC,KAAK,oBACzCoB,OAAS,GACbA,OAAOC,WAAaN,IACpBK,OAAOjB,WAAaa,IACpBI,OAAOH,OAASA,OAECK,cAAKC,KAAK,CAAC,CACrBC,WAAY,uCACZjB,KAAMa,UAEF,GAAGK,MAAK,SAASC,0BACnB,sCAAsCX,KAAKY,KAAKT,YACpC,UAAVD,QAAqC,GAAfE,kCACpB,eAAeJ,KAAKa,2BACpB,gBAAgBb,KAAKa,2BACrB,iBAAiBb,KAAKa,2BACtB,eAAeb,KAAKa,2BACpB,eAAeb,KAAKc,2BACpB,kBAAkBd,KAAKc,QAEf,UAAVZ,QAAqC,GAAfE,kCACpB,eAAeJ,KAAKa,2BACpB,gBAAgBb,KAAKa,2BACrB,iBAAiBb,KAAKa,2BACtB,eAAeb,KAAKc,QAE7BC,QAAQC,IAAI,kCACVC,MAAK,WACPF,QAAQC,IAAI,sCAIjB3B,MAAMyB,OASFI,CAAuBrC"}