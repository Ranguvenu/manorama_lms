{"version":3,"file":"questionBank.min.js","sources":["../src/questionBank.js"],"sourcesContent":["import ModalForm from 'core_form/modalform';\nimport ModalFactory from 'core/modal_factory';\nimport ModalEvents from 'core/modal_events';\nimport Ajax from 'core/ajax';\nimport {get_string as getString} from 'core/str';\nimport $ from 'jquery';\nimport Templates from 'core/templates';\nimport cfg from 'core/config';\n\n\nconst Selectors = {\n    actions: {\n        changestatus: '[data-action=\"changestatus\"]',\n    },\n};\nexport const init = (caneditordeleteatanystatus) => {\n    document.addEventListener('click', function(e) {\n      let changestatus = e.target.closest(Selectors.actions.changestatus);\n      if (changestatus) {\n        e.preventDefault();\n        const questionid = changestatus.getAttribute('data-id');\n        const status = changestatus.getAttribute('data-value');\n        const statusText = changestatus.getAttribute('data-statusText');\n        const adminstatus = changestatus.getAttribute('data-adminstatus');\n        const canreviewselfstatus = changestatus.getAttribute('data-canreviewselfstatus');\n        const hidestatus  = changestatus.getAttribute('data-hidestatus');    \n        const workshopid = changestatus.getAttribute('data-wid');\n        var params = {};\n        params.questionid = questionid;\n        params.workshopid = workshopid;\n        params.status = status;\n        switch(status){\n         case \"readytoreview\":\n         displaystatus = \"Ready to Review\";\n         break;\n         case \"underreview\":\n         displaystatus = \"Under Review\";\n         break;\n         case \"draft\":\n         displaystatus = \"Draft\";\n         break;\n         case \"reject\":\n         displaystatus = \"Reject\";\n         break;\n         case \"publish\":\n         displaystatus = \"Publish\";\n         break;\n        }\n        ModalFactory.create({\n            title: getString('statusconfirm', 'local_questions'),\n            type: ModalFactory.types.SAVE_CANCEL,\n            body: getString('confirmationbodymessage', 'local_questions', displaystatus)\n        }).done(function(modal) {\n            this.modal = modal;\n            modal.setSaveButtonText(getString('statusupdate', 'local_questions'));\n            modal.getRoot().on(ModalEvents.save, function(e) {\n                e.preventDefault();\n                var promise = Ajax.call([{\n                    methodname: 'local_questions_changequestionstatus',\n                    args: params\n                }]);\n                promise[0].done(function(resp) {\n                    $('.questioncreation_page #status_span'+questionid).text(statusText);\n                    //&& adminstatus !=1\n                    if(status == 'publish' && adminstatus !=1){\n                        $('#understatus'+questionid).hide();\n                        $('#rejectstatus'+questionid).hide();\n                        $('#publishstatus'+questionid).hide();\n                        $('#raedystatus'+questionid).hide();\n                    }\n                    if(status == 'readytoreview' && adminstatus !=1){\n                        $('#raedystatus'+questionid).hide();\n                        $('#hideeditdelete'+questionid).hide();\n                        $('#understatus'+questionid).hide();\n                    }\n                    if(status == 'readytoreview' && adminstatus ==1){\n                        $('#raedystatus'+questionid).hide();\n                        $('#understatus'+questionid).show();\n                        $('#hideeditdelete'+questionid).show();\n                    }\n                    if(status == 'reject' && adminstatus !=1){\n                        $('#understatus'+questionid).hide();\n                        $('#rejectstatus'+questionid).hide();\n                        $('#publishstatus'+questionid).hide();\n                        $('#draft'+questionid).show();\n                    }\n                    if(status == 'underreview' && adminstatus !=1){\n                        $('#understatus'+questionid).hide();\n                        $('#rejectstatus'+questionid).show();\n                        $('#publishstatus'+questionid).show();\n                    }\n                    if(status == 'readytoreview' && adminstatus == 1 && canreviewselfstatus == 1){\n                        $('#understatus'+questionid).show();\n                        $('#raedystatus'+questionid).hide();\n                        $('#hideeditdelete'+questionid).show();\n                        $('#draft'+questionid).hide();\n                    }\n                    if(status == 'readytoreview' && adminstatus == 1 && canreviewselfstatus != 1){\n                        $('#understatus'+questionid).show();\n                        $('#raedystatus'+questionid).hide();\n                        $('#hideeditdelete'+questionid).show();\n                        $('#draft'+questionid).hide();\n                    }\n                    if(status == 'underreview' && adminstatus == 1){\n                        $('#understatus'+questionid).hide();\n                        $('#rejectstatus'+questionid).show();\n                        $('#publishstatus'+questionid).show();\n                    }\n                    if(status == 'publish' && adminstatus ==1){\n                        $('#understatus'+questionid).hide();\n                        $('#rejectstatus'+questionid).hide();\n                        $('#publishstatus'+questionid).hide();\n                        $('#raedystatus'+questionid).hide();\n                        $('#draftstatus'+questionid).show();\n                    }\n                    if(status == 'reject' && adminstatus ==1){\n                        $('#understatus'+questionid).hide();\n                        $('#rejectstatus'+questionid).hide();\n                        $('#publishstatus'+questionid).hide();\n                        $('#raedystatus'+questionid).hide();\n                        $('#draft'+questionid).show();\n                        $('#hideeditdelete'+questionid).show();\n                    }\n                    if(status == 'draft' && adminstatus ==1){\n                        $('#hideeditdelete'+questionid).show();\n                        $('#raedystatus'+questionid).show();\n                        $('#draftstatus'+questionid).hide();\n                        $('#draft'+questionid).hide();\n                       \n                    }\n                    modal.hide();\n                }).fail(function() {\n                    console.log('exception');\n                });\n            }.bind(this));\n            modal.show();\n        }.bind(this));\n    }       \n    });\n}\n\n"],"names":["Selectors","changestatus","caneditordeleteatanystatus","document","addEventListener","e","target","closest","preventDefault","questionid","getAttribute","status","statusText","adminstatus","canreviewselfstatus","workshopid","params","displaystatus","create","title","type","ModalFactory","types","SAVE_CANCEL","body","done","modal","setSaveButtonText","getRoot","on","ModalEvents","save","Ajax","call","methodname","args","resp","text","hide","show","fail","console","log","bind","this"],"mappings":"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"}