/**
 * JavaScript for the add_random_form class.
 *
 * @module    mod_quiz/add_random_form
 * @copyright 2018 Ryan Wyllie <ryan@moodle.com>
 * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("local_questions/add_random_form",["jquery","local_questions/random_question_form_preview"],(function($,RandomQuestionFormPreview){var SELECTORS_PREVIEW_CONTAINER='[data-region="random-question-preview-container"]',SELECTORS_CATEGORY_FORM_ELEMENT='[name="category"]',SELECTORS_GOAL_FORM_ELEMENT='[name="goal"]',SELECTORS_BOARD_FORM_ELEMENT='[name="board"]',SELECTORS_CLASS_FORM_ELEMENT='[name="class"]',SELECTORS_COURSE_FORM_ELEMENT='[name="course"]',SELECTORS_COURSETOPICS_FORM_ELEMENT='[name="coursetopics"]',SELECTORS_CONCEPT_FORM_ELEMENT='[name="concept"]',SELECTORS_CHAPTER_FORM_ELEMENT='[name="chapter"]',SELECTORS_UNIT_FORM_ELEMENT='[name="unit"]',SELECTORS_SUBCATEGORY_FORM_ELEMENT='[name="includesubcategories"]',SELECTORS_TAG_IDS_FORM_ELEMENT='[name="fromtags[]"]',getCategorySelectValue=function(form){return form.find(SELECTORS_CATEGORY_FORM_ELEMENT).val()},getgoalId=function(form){var valueString=function(form){return form.find(SELECTORS_GOAL_FORM_ELEMENT).val()}(form);return valueString.split(",")[0]},getboardId=function(form){var valueString=function(form){return form.find(SELECTORS_BOARD_FORM_ELEMENT).val()}(form);return valueString.split(",")[0]},getclassId=function(form){var valueString=function(form){return form.find(SELECTORS_CLASS_FORM_ELEMENT).val()}(form);return valueString.split(",")[0]},getcourseId=function(form){var valueString=function(form){return form.find(SELECTORS_COURSE_FORM_ELEMENT).val()}(form);return valueString.split(",")[0]},getcoursetopicsId=function(form){var valueString=function(form){return form.find(SELECTORS_COURSETOPICS_FORM_ELEMENT).val()}(form);return valueString.split(",")[0]},getchapterId=function(form){var valueString=function(form){return form.find(SELECTORS_CHAPTER_FORM_ELEMENT).val()}(form);return valueString.split(",")[0]},getunitId=function(form){var valueString=function(form){return form.find(SELECTORS_UNIT_FORM_ELEMENT).val()}(form);return valueString.split(",")[0]},getconceptId=function(form){var valueString=function(form){return form.find(SELECTORS_CONCEPT_FORM_ELEMENT).val()}(form);return valueString.split(",")[0]},shouldIncludeSubcategories=function(form,topCategories){return!!function(form,topCategories){var selectedValue=getCategorySelectValue(form);return topCategories.indexOf(selectedValue)>-1}(form,topCategories)||form.find(SELECTORS_SUBCATEGORY_FORM_ELEMENT).is(":checked")},reloadQuestionPreview=function(form,contextId,topCategories){var previewContainer=form.find(SELECTORS_PREVIEW_CONTAINER);RandomQuestionFormPreview.reload(previewContainer,function(form){return getCategorySelectValue(form).split(",")[0]}(form),shouldIncludeSubcategories(form,topCategories),function(form){return form.find(SELECTORS_TAG_IDS_FORM_ELEMENT).val().map((function(value){return value.split(",")[0]}))}(form),contextId,getgoalId(form),getboardId(form),getclassId(form),getcourseId(form),getcoursetopicsId(form),getchapterId(form),getunitId(form),getconceptId(form))},addEventListeners=function(form,contextId,topCategories){var reloadTimerId=null;const tagsFilter=form.find(SELECTORS_TAG_IDS_FORM_ELEMENT);form.add(tagsFilter).on("change",(function(e){var element;((element=$(e.target)).closest(SELECTORS_CATEGORY_FORM_ELEMENT).length>0||element.closest(SELECTORS_SUBCATEGORY_FORM_ELEMENT).length>0||element.closest(SELECTORS_TAG_IDS_FORM_ELEMENT).length>0)&&(RandomQuestionFormPreview.showLoadingIcon(form),reloadTimerId&&clearTimeout(reloadTimerId),reloadTimerId=setTimeout((function(){reloadQuestionPreview(form,contextId,topCategories)}),2e3))}));const goalfilter=form.find(SELECTORS_GOAL_FORM_ELEMENT);form.add(goalfilter).on("change",(function(e){RandomQuestionFormPreview.showLoadingIcon(form),reloadTimerId&&clearTimeout(reloadTimerId),reloadTimerId=setTimeout((function(){reloadQuestionPreview(form,contextId,topCategories)}),2e3)}));const boardfilter=form.find(SELECTORS_BOARD_FORM_ELEMENT);form.add(boardfilter).on("change",(function(e){RandomQuestionFormPreview.showLoadingIcon(form),reloadTimerId&&clearTimeout(reloadTimerId),reloadTimerId=setTimeout((function(){reloadQuestionPreview(form,contextId,topCategories)}),2e3)}));const classfilter=form.find(SELECTORS_CLASS_FORM_ELEMENT);form.add(classfilter).on("change",(function(e){RandomQuestionFormPreview.showLoadingIcon(form),reloadTimerId&&clearTimeout(reloadTimerId),reloadTimerId=setTimeout((function(){reloadQuestionPreview(form,contextId,topCategories)}),2e3)}));const coursefilter=form.find(SELECTORS_COURSE_FORM_ELEMENT);form.add(coursefilter).on("change",(function(e){RandomQuestionFormPreview.showLoadingIcon(form),reloadTimerId&&clearTimeout(reloadTimerId),reloadTimerId=setTimeout((function(){reloadQuestionPreview(form,contextId,topCategories)}),2e3)}));const coursetopicsfilter=form.find(SELECTORS_COURSETOPICS_FORM_ELEMENT);form.add(coursetopicsfilter).on("change",(function(e){RandomQuestionFormPreview.showLoadingIcon(form),reloadTimerId&&clearTimeout(reloadTimerId),reloadTimerId=setTimeout((function(){reloadQuestionPreview(form,contextId,topCategories)}),2e3)}));const chapterfilter=form.find(SELECTORS_CHAPTER_FORM_ELEMENT);form.add(chapterfilter).on("change",(function(e){RandomQuestionFormPreview.showLoadingIcon(form),reloadTimerId&&clearTimeout(reloadTimerId),reloadTimerId=setTimeout((function(){reloadQuestionPreview(form,contextId,topCategories)}),2e3)}));const unitfilter=form.find(SELECTORS_UNIT_FORM_ELEMENT);form.add(unitfilter).on("change",(function(e){RandomQuestionFormPreview.showLoadingIcon(form),reloadTimerId&&clearTimeout(reloadTimerId),reloadTimerId=setTimeout((function(){reloadQuestionPreview(form,contextId,topCategories)}),2e3)}));const conceptfilter=form.find(SELECTORS_CONCEPT_FORM_ELEMENT);form.add(conceptfilter).on("change",(function(e){RandomQuestionFormPreview.showLoadingIcon(form),reloadTimerId&&clearTimeout(reloadTimerId),reloadTimerId=setTimeout((function(){reloadQuestionPreview(form,contextId,topCategories)}),2e3)}))};return{init:function(formId,contextId,topCategories,isTagsEnabled){if(1==isTagsEnabled){var form=$("#"+formId);reloadQuestionPreview(form,contextId,topCategories),addEventListeners(form,contextId,topCategories)}}}}));

//# sourceMappingURL=add_random_form.min.js.map